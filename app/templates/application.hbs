<h1><img src="assets/perfo.svg"> Perfo</h1>

{{#if isCircleCIReady}}
  {{#if userName}}
    <nav>
      <section class="nav-auth">
        Authenticated as {{userName}}
        <button {{action "unsetToken" on="click"}}>Deauth</button>
      </section>

      <section class="nav-project">
        {{#power-select
          selected=selectedProject
          options=projects
          onchange=(action (mut selectedProject))
          placeholder="Select a project..."
          as |project|
        }}
          {{project.displayName}}
        {{/power-select}}
      </section>
    </nav>

    {{#if selectedProject}}
      {{#if isLoadingBuilds}}
        Loading build data for project...
      {{else}}
        <section class="chart-container">
          {{high-charts chartOptions=chartOptions content=chartData}}
        </section>
      {{/if}}
    {{/if}}
  {{else}}
    <nav class="auth">
        <section class="nav-auth">
      Please give us a CircleCI API token to access your account.
    If you don't have a token yet, <a href="https://circleci.com/account/api" target="_blank">click here</a> to create one.
  </section>
        <section class="nav-auth">
    <form {{action "setToken" on="submit"}}>
      {{input type="text" placeholder="CircleCI auth token" value=authToken}}
      <button type="submit">Authenticate</button>
    </form>
  </section>
  </nav>
  {{/if}}
{{else}}
  Checking CircleCI authentication...
{{/if}}
